import{d as L,o as k,a as z,b as y,c as w,e as ae,f as e,t as v,r as M,i as j,n as A,g as Z,h as G,w as ne,v as oe,j as ie,s as $,l as q,k as le,m as re,p as ee,q as W,u as K,F as H,x as O,y as te,z as E,A as ce,B as V,C as de,D as ue,P as J,G as ve,S as me,W as fe,E as pe,O as _e,H as ge,I as he,V as ye,J as be,K as we,L as Me,M as U,N as S,Q as xe,R as Le,T as Ce,U as De,X as Q,Y as $e,Z as Se}from"./vendor-Br2fLRdT.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const ke={class:"layout-header"},Pe={class:"header-right"},Ee=L({__name:"LayoutHeader",setup(p){const a=M(""),i=M(""),c=M(""),t=()=>{const l=new Date,u=l.getHours().toString().padStart(2,"0"),f=l.getMinutes().toString().padStart(2,"0"),d=l.getSeconds().toString().padStart(2,"0");a.value=`${u}:${f}:${d}`;const r=l.getFullYear(),s=(l.getMonth()+1).toString().padStart(2,"0"),g=l.getDate().toString().padStart(2,"0");i.value=`${r}-${s}-${g}`;const D=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];c.value=D[l.getDay()]};let o=null;return k(()=>{t(),o=window.setInterval(t,1e3)}),z(()=>{o&&(clearInterval(o),o=null)}),(l,u)=>(y(),w("div",ke,[u[0]||(u[0]=ae('<div class="header-midden" data-v-fb70a80a><div class="cn" data-v-fb70a80a>数据中心数字孪生智能运维平台</div><div class="en" data-v-fb70a80a> Data Center Digital Twin Intelligent Operation Platform </div></div><div class="header-left" data-v-fb70a80a><i class="fa-regular fa-envelope" data-v-fb70a80a></i><div class="message" content="【系统通知】感谢大家对我们项目的关注与支持!希望能为我们的项目点一个Star,您的支持对我们来说至关重要。" data-v-fb70a80a></div></div>',2)),e("div",Pe,[e("span",null,v(a.value),1),e("span",null,v(i.value),1),e("span",null,v(c.value),1)])]))}}),C=(p,a)=>{const i=p.__vccOpts||p;for(const[c,t]of a)i[c]=t;return i},Te=C(Ee,[["__scopeId","data-v-fb70a80a"]]),Ae={class:"layout-footer"},We=L({__name:"LayoutFooter",setup(p){const a=Z({isWarming:!1}),i=j("events"),c=async()=>{a.isWarming=!a.isWarming,a.isWarming&&i?i.startWarming():i&&i.stopWarming()},t=G(()=>{const o={};return o.cursor="pointer",a.isWarming?o.color="#5bc7fa":o.color="#fff",o});return(o,l)=>(y(),w("div",Ae,[e("div",{class:"item",style:A(t.value),onClick:c},v(a.isWarming?"取消告警":"设备告警"),5)]))}}),ze=C(We,[["__scopeId","data-v-a0512409"]]),Ie={class:"layout-loading"},He={class:"loading-tip"},Oe=L({__name:"LayoutLoading",props:{loading:{}},setup(p){return(a,i)=>ne((y(),w("div",Ie,[i[0]||(i[0]=e("div",{class:"loading-gif"},null,-1)),e("div",He," 模型正在加载中 ("+v(p.loading.loaded)+"/"+v(p.loading.total)+") ... ",1)],512)),[[oe,p.loading.isLoading]])}}),Re=C(Oe,[["__scopeId","data-v-c607f5e9"]]);function Fe(){const p=M(null),a=$(null),i=()=>{var l;return(l=a.value)==null?void 0:l.resize()},c=()=>{var l;return(l=a.value)==null?void 0:l.clear()},t=(l="light")=>{var u;a.value&&((u=a.value)==null||u.dispose()),q.isElement(p.value)?a.value=le(p.value,l):console.warn("容器还未初始化"),window.removeEventListener("resize",i),window.addEventListener("resize",i)},o=l=>{var u;a.value||t(),(u=a.value)==null||u.setOption(l)};return z(()=>{window.removeEventListener("resize",i)}),k(()=>{window.addEventListener("resize",i)}),{container:p,chart:a,setOption:o,resize:i,clear:c,echarts:ie}}const Ne={class:"layout-panel"},Be={class:"panel-header"},Ue={class:"panel-header-title"},je={class:"panel-body"},Ve=L({__name:"LayoutPanel",props:{title:{}},setup(p){return(a,i)=>(y(),w("div",Ne,[e("div",Be,[e("div",Ue,v(p.title),1)]),e("div",je,[re(a.$slots,"default",{},void 0)])]))}}),Y=C(Ve,[["__scopeId","data-v-9556f20e"]]),Ge=L({__name:"WidgetPanel01",setup(p){const{container:a,echarts:i,setOption:c}=Fe(),t=()=>{const u=[],f=new Date;for(let d=60;d>=0;d-=1){const r=new Date(f.getTime()-d*60*1e3),s=String(r.getMinutes()).padStart(2,"0");u.push(`${r.getHours()}:${s}`)}return u},o=()=>{const u=[];for(let d=60;d>=0;d-=1){const r=Math.random()*10-5,s=Math.max(0,Math.min(100,5+r+Math.sin(d/10)*5));u.push(s.toFixed(1))}return u},l=()=>({legend:{show:!1},tooltip:{trigger:"axis",backgroundColor:"#000",borderColor:"#333",textStyle:{color:"#fff"},formatter(u){const f=u[0];return`<div style="padding: 5px 0;">
          <div style="color: #fff; font-size: 14px;">${f.name}</div>
          <div style="color: #00fea9; font-size: 16px; margin-top: 5px;">故障变化率: ${f.value}%</div>
        </div>`}},grid:{left:"4%",right:"4%",bottom:"0%",top:"20%",containLabel:!0},xAxis:{type:"category",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#fff",margin:10,fontSize:12,interval:9},data:t()},yAxis:{type:"value",name:"故障变化率(%)",nameTextStyle:{color:"#fff",fontSize:12},axisLabel:{color:"#fff"},splitLine:{lineStyle:{color:"#c8c8c830",type:"dashed"}},min:0,max:100},series:[{name:"故障变化率",type:"line",smooth:!0,symbol:"none",lineStyle:{color:"rgba(0, 254, 169, 1)",width:2},areaStyle:{color:new i.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 254, 169, 0.3)"},{offset:1,color:"rgba(0, 254, 169, 0.01)"}])},data:o()}]});return k(()=>{ee(()=>{const u=l();c(u)})}),(u,f)=>(y(),W(Y,{title:"设备故障变化率"},{default:K(()=>[e("div",{class:"container",ref_key:"container",ref:a},null,512)]),_:1}))}}),qe=C(Ge,[["__scopeId","data-v-0544581d"]]),Ke={class:"weather-monitor"},Ye={class:"weather-label"},Je={class:"weather-value"},Qe={class:"value"},Xe={class:"unit"},Ze=L({__name:"WidgetPanel04",setup(p){const a=[{icon:"fa-solid fa-server",label:"服务器机柜",value:"23",unit:"个"},{icon:"fa-solid fa-network-wired",label:"网络设备",value:"23",unit:"个"},{icon:"fa-solid fa-bolt",label:"电源柜",value:"23",unit:"个"},{icon:"fa-solid fa-temperature-three-quarters",label:"温湿度传感器",value:"11",unit:"个"},{icon:"fa-solid fa-snowflake",label:"空调系统",value:"63",unit:"个"},{icon:"fa-solid fa-shield-alt",label:"防火墙",value:"23",unit:"个"},{icon:"fa-solid fa-ethernet",label:"交换机",value:"12",unit:"个"},{icon:"fa-solid fa-database",label:"存储设备",value:"12",unit:"个"},{icon:"fa-solid fa-video",label:"监控设备",value:"13",unit:"个"}];return(i,c)=>(y(),W(Y,{title:"设备规模"},{default:K(()=>[e("div",Ke,[(y(),w(H,null,O(a,(t,o)=>e("div",{key:o,class:"widget-weather-item"},[e("div",{class:te(["weather-icon",t.icon])},null,2),e("div",Ye,v(t.label),1),e("div",Je,[e("span",Qe,v(t.value),1),e("span",Xe,v(t.unit),1)])])),64))])]),_:1}))}}),et=C(Ze,[["__scopeId","data-v-bfd63f68"]]),tt={class:"content"},st={class:"device-info"},at={class:"device-name"},nt={class:"device-event"},ot={class:"device-time"},it=L({__name:"AlarmDeviceList",props:{devices:{}},emits:["close"],setup(p,{emit:a}){const i=p,c=a,t=M(i.devices),o=f=>({1:"#74fabd",2:"#5bc7fa",3:"#f1bd49"})[f],l=f=>({1:"一般",2:"中等",3:"严重"})[f],u=()=>{c("close")};return(f,d)=>(y(),w("div",{class:"alarm-device-list",onClick:d[0]||(d[0]=E(()=>{},["stop"]))},[e("div",{class:"header"},[d[1]||(d[1]=e("div",{class:"title"},"告警设备列表",-1)),e("div",{class:"close-btn",onClick:u},"×")]),e("div",tt,[(y(!0),w(H,null,O(t.value,r=>(y(),w("div",{class:"device-item",key:r.id},[e("div",st,[e("div",at,v(r.name),1),e("div",nt,v(r.event),1)]),e("div",ot,v(r.time),1),e("div",{class:"device-type",style:A({background:o(r.type)})},v(l(r.type)),5)]))),128))])]))}}),lt=C(it,[["__scopeId","data-v-9760bf3f"]]),rt={class:"item-name"},ct={class:"item-type"},dt={class:"item-time"},ut=L({__name:"WidgetPanel06",setup(p){const{disableControls:a,enableControls:i}=j("events"),c=j("mask"),t=M(!1);ce(t,r=>{r?(a(),c.show()):(i(),c.hide())});const o=M([{name:"1#服务器机柜",event:"温度过高",type:1,time:"08:21"},{name:"23#网络设备",event:"网络异常",type:3,time:"08:32"},{name:"9#电源柜",event:"电压波动",type:2,time:"09:44"},{name:"2#服务器机柜",event:"内存过载",type:3,time:"12:53"},{name:"18#空调系统",event:"制冷异常",type:3,time:"14:15"},{name:"7#UPS设备",event:"电池低电压",type:2,time:"14:45"},{name:"26#交换机",event:"端口故障",type:2,time:"14:59"},{name:"3#服务器机柜",event:"硬盘故障",type:1,time:"16:42"},{name:"6#网络设备",event:"丢包率过高",type:2,time:"17:43"},{name:"1#服务器机柜",event:"CPU过载",type:1,time:"08:21"},{name:"23#温湿度传感器",event:"湿度超标",type:3,time:"08:32"},{name:"9#防火墙",event:"流量异常",type:2,time:"09:44"},{name:"2#电源柜",event:"电流过高",type:3,time:"12:53"},{name:"18#服务器机柜",event:"风扇故障",type:3,time:"14:15"},{name:"7#路由器",event:"连接中断",type:2,time:"14:45"},{name:"26#负载均衡器",event:"性能下降",type:2,time:"14:59"},{name:"7#服务器机柜",event:"内存泄漏",type:2,time:"14:45"},{name:"26#存储设备",event:"读写错误",type:2,time:"14:59"},{name:"7#备份系统",event:"备份失败",type:2,time:"14:45"},{name:"26#监控设备",event:"信号丢失",type:2,time:"14:59"},{name:"7#安全设备",event:"入侵检测",type:2,time:"14:45"},{name:"26#门禁系统",event:"权限异常",type:2,time:"14:59"},{name:"7#消防设备",event:"烟雾报警",type:2,time:"14:45"},{name:"26#环境传感器",event:"温度异常",type:2,time:"14:59"}]),l=G(()=>o.value.map((r,s)=>({id:s,name:r.name,event:r.event,type:r.type,time:r.time}))),u=M(),f=(r,s=!1)=>{const g={1:"#74fabd",2:"#5bc7fa",3:"#f1bd49"};return s?`linear-gradient(90deg, ${g[r]}77 , transparent )`:g[r]};let d=null;return k(()=>{d&&window.clearInterval(d),d=setInterval(()=>{u.value.classList.add("scroll"),setTimeout(()=>{if(!d)return;u.value.classList.remove("scroll");const r=o.value.shift();r&&o.value.push(r)},2e3)},3e3)}),z(()=>{d&&(window.clearInterval(d),d=null)}),(r,s)=>(y(),W(Y,{title:"预警情况"},{default:K(()=>[e("div",{class:"wrap",onClick:s[0]||(s[0]=g=>t.value=!0)},[e("div",{class:"item-list",ref_key:"container",ref:u},[(y(!0),w(H,null,O(o.value,(g,D)=>(y(),w("div",{class:"item",key:D,style:A({background:f(g.type,!0)})},[e("div",{class:"item-circle",style:A({background:f(g.type)})},null,4),e("div",rt,v(g.name),1),e("div",ct,v(g.event),1),e("div",dt,v(g.time),1)],4))),128))],512)]),t.value?(y(),W(lt,{key:0,devices:l.value,onClose:s[1]||(s[1]=g=>t.value=!1),onClick:s[2]||(s[2]=E(()=>{},["stop"]))},null,8,["devices"])):V("",!0)]),_:1}))}}),vt=C(ut,[["__scopeId","data-v-11b6b20f"]]),mt={class:"header"},ft={class:"title"},pt={class:"content"},_t={class:"info-section"},gt={class:"info-item"},ht={class:"info-value"},yt={class:"info-item"},bt={class:"info-item"},wt={class:"info-value"},Mt={class:"info-item"},xt={class:"info-value"},Lt={class:"info-section"},Ct={class:"info-item"},Dt={class:"info-value"},$t={class:"info-item"},St={class:"info-value"},kt={class:"info-item"},Pt={class:"info-value"},Et={class:"info-item"},Tt={class:"info-value"},At={class:"info-item"},Wt={class:"info-value"},zt={class:"info-section"},It={class:"info-item"},Ht={class:"info-value"},Ot={class:"info-item"},Rt={class:"info-value"},Ft={class:"info-item"},Nt={class:"info-value"},Bt={class:"info-item"},Ut={class:"info-value"},jt={class:"info-section"},Vt={class:"alarm-list"},Gt={class:"alarm-info"},qt={class:"alarm-name"},Kt={class:"alarm-time"},Yt=L({__name:"DeviceDetailPanel",props:{deviceData:{}},emits:["close"],setup(p,{emit:a}){const i=p,c=a,t=G(()=>i.deviceData),o=r=>({normal:"status-normal",warning:"status-warning",error:"status-error"})[r]||"status-normal",l=r=>({normal:"正常",warning:"警告",error:"故障"})[r]||"正常",u=r=>({warning:"#f1bd49",error:"#ff0000",info:"#5bc7fa"})[r]||"#5bc7fa",f=r=>({warning:"⚠",error:"❌",info:"ℹ"})[r]||"ℹ",d=()=>{c("close")};return(r,s)=>(y(),w("div",{class:"device-detail-panel",onClick:s[0]||(s[0]=E(()=>{},["stop"]))},[e("div",mt,[e("div",ft,v(t.value.name),1),e("div",{class:"close-btn",onClick:E(d,["stop"])},"×")]),e("div",pt,[e("div",_t,[s[5]||(s[5]=e("div",{class:"info-title"},"设备基本信息",-1)),e("div",gt,[s[1]||(s[1]=e("div",{class:"info-label"},"设备类型",-1)),e("div",ht,v(t.value.type),1)]),e("div",yt,[s[2]||(s[2]=e("div",{class:"info-label"},"设备状态",-1)),e("div",{class:te(["info-value",o(t.value.status)])},v(l(t.value.status)),3)]),e("div",bt,[s[3]||(s[3]=e("div",{class:"info-label"},"设备编号",-1)),e("div",wt,v(t.value.serialNumber),1)]),e("div",Mt,[s[4]||(s[4]=e("div",{class:"info-label"},"安装位置",-1)),e("div",xt,v(t.value.location),1)])]),e("div",Lt,[s[11]||(s[11]=e("div",{class:"info-title"},"实时参数",-1)),e("div",Ct,[s[6]||(s[6]=e("div",{class:"info-label"},"温度",-1)),e("div",Dt,v(t.value.temperature)+"°C",1)]),e("div",$t,[s[7]||(s[7]=e("div",{class:"info-label"},"湿度",-1)),e("div",St,v(t.value.humidity)+"%",1)]),e("div",kt,[s[8]||(s[8]=e("div",{class:"info-label"},"电压",-1)),e("div",Pt,v(t.value.voltage)+"V",1)]),e("div",Et,[s[9]||(s[9]=e("div",{class:"info-label"},"电流",-1)),e("div",Tt,v(t.value.current)+"A",1)]),e("div",At,[s[10]||(s[10]=e("div",{class:"info-label"},"功率",-1)),e("div",Wt,v(t.value.power)+"W",1)])]),e("div",zt,[s[16]||(s[16]=e("div",{class:"info-title"},"运行状态",-1)),e("div",It,[s[12]||(s[12]=e("div",{class:"info-label"},"CPU 负载",-1)),e("div",Ht,v(t.value.cpuLoad)+"%",1)]),e("div",Ot,[s[13]||(s[13]=e("div",{class:"info-label"},"内存使用",-1)),e("div",Rt,v(t.value.memoryUsage)+"%",1)]),e("div",Ft,[s[14]||(s[14]=e("div",{class:"info-label"},"磁盘使用",-1)),e("div",Nt,v(t.value.diskUsage)+"%",1)]),e("div",Bt,[s[15]||(s[15]=e("div",{class:"info-label"},"网络流量",-1)),e("div",Ut,v(t.value.networkTraffic)+" Mbps",1)])]),e("div",jt,[s[17]||(s[17]=e("div",{class:"info-title"},"告警信息",-1)),e("div",Vt,[(y(!0),w(H,null,O(t.value.alarms,g=>(y(),w("div",{class:"alarm-item",key:g.id},[e("div",{class:"alarm-icon",style:A({background:u(g.type)})},v(f(g.type)),5),e("div",Gt,[e("div",qt,v(g.name),1),e("div",Kt,v(g.time),1)])]))),128))])])])]))}}),Jt=C(Yt,[["__scopeId","data-v-eccd312f"]]),se=de(),Qt={class:"label-wrapper"},Xt=L({__name:"WidgetLabel",props:{name:{},position:{}},setup(p){const a=p,i=()=>{se.emit("showDeviceDetail",c())},c=()=>{const t={name:a.name,type:"未知设备",status:"normal",serialNumber:`1000${Math.floor(Math.random()*9e3)}`,location:"数据中心 A 区",temperature:Math.floor(Math.random()*30)+20,humidity:Math.floor(Math.random()*40)+40,voltage:Math.floor(Math.random()*20)+220,current:Math.floor(Math.random()*10)+5,power:Math.floor(Math.random()*2e3)+1e3,cpuLoad:Math.floor(Math.random()*60)+20,memoryUsage:Math.floor(Math.random()*50)+30,diskUsage:Math.floor(Math.random()*40)+40,networkTraffic:Math.floor(Math.random()*1e3)+500,alarms:[]};return a.name.includes("服务器机柜")?(t.type="服务器机柜",t.status="normal",t.alarms=[{id:1,name:"温度过高",type:"warning",time:"10:23"},{id:2,name:"内存过载",type:"error",time:"09:15"}]):a.name.includes("网络设备")?(t.type="网络设备",t.status="warning",t.alarms=[{id:1,name:"网络延迟过高",type:"warning",time:"11:05"}]):a.name.includes("电源柜")?(t.type="电源柜",t.status="normal",t.alarms=[]):(t.type="其他设备",t.status="normal",t.alarms=[]),t};return(t,o)=>(y(),w("div",Qt,[e("div",{class:"label",onClick:E(i,["stop"])},v(p.name),1)]))}}),Zt=C(Xt,[["__scopeId","data-v-cd19219b"]]);function es(p){const a=p||M(null),i=$(null),c=$(null),t=$(null),o=$(null),l=$(null),u=new Map,f=[],d=new be,r=new Map,s=()=>{const _=d.getDelta();if(t.value&&i.value&&c.value){t.value.render(i.value,c.value);const m=d.getDelta();f.forEach(n=>n.update(m)),u.forEach(n=>n.render(_)),r.forEach(n=>q.isFunction(n)&&n(_)),o.value&&o.value.render(i.value,c.value),we.update()}requestAnimationFrame(s)},g=()=>{if(!a.value)return;const{clientWidth:_,clientHeight:m}=a.value;if(i.value=new me,c.value=new J(45,_/m,1,1e4),c.value.position.set(20,15,20),t.value=new fe({antialias:!0,alpha:!0}),t.value.shadowMap.enabled=!1,t.value.setSize(_,m),t.value.setClearAlpha(.5),a.value.appendChild(t.value.domElement),o.value=new pe,o.value.setSize(_,m),o.value.domElement.className="css2d-renderer",o.value.domElement.style.position="absolute",o.value.domElement.style.top="0px",o.value.domElement.style.pointerEvents="none",o.value.domElement.style.zIndex="100",a.value.appendChild(o.value.domElement),c.value&&t.value&&(l.value=new _e(c.value,t.value.domElement),l.value.minPolarAngle=0,l.value.enableDamping=!0,l.value.dampingFactor=.1,l.value.target.set(0,5,0),l.value.maxPolarAngle=Math.PI/2,l.value.minDistance=10,l.value.maxDistance=100,l.value.update()),i.value){const n=new ge(10066329,10);i.value.add(n);const h=new he(16777215,.5);h.position.set(20,20,20),h.position.multiplyScalar(1),h.castShadow=!0,h.shadow.mapSize=new ye(1024,1024),i.value.add(h)}},D=new ue;D.setDecoderPath("/js/draco/gltf/"),D.setDecoderConfig({type:"js"});const R=_=>{const m=new ve;m.setDRACOLoader(D);const n=(x,T)=>T(x),h=(x,T)=>{console.error("模型加载失败:",_,x),T(x)};return new Promise((x,T)=>{m.load(_,B=>n(B,x),void 0,B=>h(B,T))})},F=new Promise((_,m)=>{k(()=>{const n=()=>{console.log("boostrap 调用时 container.value:",a.value);try{if(!a.value||a.value.clientHeight===0){console.log("容器尺寸为0，等待DOM更新"),setTimeout(n,100);return}g(),i.value&&c.value&&t.value?(console.log("Three.js 场景初始化成功"),window.addEventListener("resize",I),s(),_()):(console.error("Three.js 场景初始化失败：缺少必要组件",{scene:!!i.value,camera:!!c.value,renderer:!!t.value,container:!!a.value}),m(new Error("Three.js 场景初始化失败")))}catch(h){console.error("Three.js 场景初始化过程中发生错误：",h),m(h)}};a.value?(console.log("容器已经准备好，立即初始化"),n()):(console.log("容器尚未准备好，等待 500ms 后重试"),setTimeout(n,500))}),z(()=>{window.removeEventListener("resize",I)})}),I=()=>{if(!a.value||!c.value||!t.value||!o.value)return;const{clientWidth:_,clientHeight:m}=a.value;c.value instanceof J&&(c.value.aspect=_/m,c.value.updateProjectionMatrix()),t.value.setSize(_,m),o.value.setSize(_,m)};return{container:a,scene:i,camera:c,renderer:t,cssRenderer:o,controls:l,mixers:f,renderMixins:r,composers:u,loadGltf:R,enableControls:()=>{l.value&&(l.value.enabled=!0)},disableControls:()=>{l.value&&(l.value.enabled=!1)},boostrapPromise:F}}const P={BuildingModel:"/models/base.glb",DeviceModel:"/models/devices.glb",LineModel:"/models/lines.gltf"},X=[{name:"1# 服务器机柜",position:[-32,8,-22]},{name:"2# 服务器机柜",position:[-20.2,8,-22]},{name:"3# 服务器机柜",position:[-8.4,8,-22]},{name:"4# 服务器机柜",position:[3.4,8,-22]},{name:"5# 服务器机柜",position:[15.2,8,-22]},{name:"6# 服务器机柜",position:[27,8,-22]},{name:"1# 网络设备",position:[-32,8,-6]},{name:"2# 网络设备",position:[-20.2,8,-6]},{name:"3# 网络设备",position:[-8.4,8,-6]},{name:"4# 网络设备",position:[3.4,8,-6]},{name:"5# 网络设备",position:[15.2,8,-6]},{name:"6# 网络设备",position:[27,8,-6]},{name:"1# 电源柜",position:[-33,6,14]},{name:"2# 电源柜",position:[-21.2,6,14]},{name:"3# 电源柜",position:[-9.4,6,14]},{name:"4# 电源柜",position:[2.4,6,14]},{name:"5# 电源柜",position:[14.2,6,14]},{name:"6# 电源柜",position:[26,6,14]}];function ts(p){const{container:a,scene:i,loadGltf:c,renderMixins:t,enableControls:o,disableControls:l,boostrapPromise:u}=es(p),f={building:null,devices:null,lines:null},d=Z({total:3,loaded:0,isLoading:!0}),r=$([]),s=M(null),g=$(null),D=async()=>{const b=async()=>{try{console.log("开始加载建筑模型:",P.BuildingModel);const n=await c(P.BuildingModel);d.loaded+=1,f.building=n.scene,i.value.add(n.scene),console.log("建筑模型加载成功")}catch(n){console.error("建筑模型加载失败:",n),d.loaded+=1}},_=async()=>{try{console.log("开始加载设备模型:",P.DeviceModel);const n=await c(P.DeviceModel);n.scene.children[4]&&n.scene.children[4].children?r.value.push(...n.scene.children[4].children):console.warn("设备模型结构不符合预期"),d.loaded+=1,f.devices=n.scene,i.value.add(n.scene),console.log("设备模型加载成功")}catch(n){console.error("设备模型加载失败:",n),d.loaded+=1}},m=async()=>{try{console.log("开始加载线路模型:",P.LineModel);const n=await c(P.LineModel);d.loaded+=1,f.lines=n.scene,i.value.add(n.scene),console.log("线路模型加载成功")}catch(n){console.error("线路模型加载失败:",n),d.loaded+=1}};await Promise.all([b(),_(),m()]),d.isLoading=!1,d.loaded=3},R=()=>{if(!f.building)return;const b=[];f.building.traverse(m=>{if("name"in m&&m.name.includes("道路箭头")){const n=m;b.push(n.material.map)}});const _=()=>{b.forEach(m=>{const n=m;n.offset.y=(n.offset.y+.02)%1e4})};t.set("road-arrow",_)},F=()=>{if(console.log("addDeviceLabels 函数被调用"),!i.value){console.warn("场景未初始化，无法添加设备标签");return}const b=(_,m)=>{const n=L({render(){return Le(_,m)}}),h=S(n);return xe(h,document.createElement("div")),h.el};console.log("LabelPositions 数组长度:",X.length),X.forEach((_,m)=>{console.log(`正在添加第 ${m+1} 个设备标签:`,_);const n=b(Zt,_);if(n){console.log("成功创建 DOM 元素:",n.outerHTML);const h=new Me(n);h.position.set(_.position[0],_.position[1],_.position[2]),i.value.add(h),console.log("成功添加到场景")}else console.warn("无法创建 DOM 元素")})},I=()=>{const b=()=>{g.value&&g.value.traverse(m=>{if(!(m instanceof U))return;const n=m;Array.isArray(n.material)?n.material.forEach(h=>{h&&"emissive"in h&&h.emissive.setHex(n.currentHex)}):n.material&&"emissive"in n.material&&n.material.emissive.setHex(n.currentHex)});const _=q.sample([0,1,2,3,4,5]);g.value=r.value[_],g.value.traverse(m=>{if(!(m instanceof U))return;const n=m;Array.isArray(n.material)?n.material=n.material.map(x=>x.clone()):n.material=n.material.clone();const h=Array.isArray(n.material)?n.material[0]:n.material;if(h&&"emissive"in h){const x=h;n.currentHex=n.currentHex??x.emissive.getHex(),x.emissive.setHex(16711680)}})};b(),s.value=setInterval(b,1e3*2)},N=()=>{g.value&&g.value.traverse(b=>{if(!(b instanceof U))return;const _=b;b.material.emissive.setHex(_.currentHex)}),s.value&&(window.clearInterval(s.value),s.value=null)};return k(()=>{console.log("useDataCenter onMounted 钩子被调用"),ee(async()=>{try{console.log("开始等待 boostrapPromise 解析"),await u,console.log("boostrapPromise 已解析"),i.value?(console.log("场景已初始化，开始加载模型"),await D(),R(),F()):console.error("场景初始化失败，无法继续加载模型")}catch(b){console.error("初始化过程中发生错误：",b)}})}),z(()=>{N()}),{container:a,loadModel:D,loading:d,startWarming:I,stopWarming:N,enableControls:o,disableControls:l}}const ss={class:"layout"},as={class:"layout-main"},ns={class:"main-left"},os={class:"main-right"},is={key:0,class:"mask"},ls=L({__name:"App",setup(p){const a=M(null),{loading:i,startWarming:c,stopWarming:t,enableControls:o,disableControls:l}=ts(a);Ce(()=>{});const u=M(!1),f=M(null);return k(()=>{se.on("showDeviceDetail",d=>{f.value=d})}),Q("mask",{show:()=>{u.value=!0},hide:()=>{u.value=!1}}),Q("events",{startWarming:c,stopWarming:t,enableControls:o,disableControls:l}),(d,r)=>(y(),w("div",ss,[S(Te),S(ze),S(Re,{loading:De(i)},null,8,["loading"]),e("div",as,[e("div",ns,[S(et)]),e("div",os,[S(qe),S(vt)]),e("div",{class:"main-middle",ref_key:"threeContainer",ref:a},null,512),u.value?(y(),w("div",is)):V("",!0)]),f.value?(y(),W(Jt,{key:0,"device-data":f.value,onClose:r[0]||(r[0]=s=>f.value=null),onClick:r[1]||(r[1]=E(()=>{},["stop"]))},null,8,["device-data"])):V("",!0)]))}}),rs=C(ls,[["__scopeId","data-v-1eed6e57"]]),cs=async()=>{$e(rs).mount("#app");const a=[1920,1080];Se.init({el:"#app",dw:a[0],dh:a[1],resize:!0})};cs();
