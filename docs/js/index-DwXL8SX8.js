import{d as x,o as y,c as w,a as se,i as B,b as e,t as m,n as A,r as Z,e as V,w as ae,v as ne,f as I,g as T,h as oe,s as D,j as C,l as G,k as ie,m as le,p as ee,q as W,u as q,F as H,x as O,y as te,z as P,A as re,B as K,D as ce,P as Q,G as de,S as ve,W as ue,C as me,O as fe,E as pe,H as _e,V as ge,I as he,J as ye,K as be,M as j,L as k,N as we,Q as Me,R as xe,T as Le,U as X,X as Ce,Y as $e}from"./vendor-B934W0xk.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();const De={class:"layout-header"},ke=x({__name:"LayoutHeader",setup(f){return(n,i)=>(y(),w("div",De,[...i[0]||(i[0]=[se('<div class="header-midden" data-v-17e2787c><div class="cn" data-v-17e2787c>数据中心数字孪生智能运维平台</div><div class="en" data-v-17e2787c> Data Center Digital Twin Intelligent Operation Platform </div></div><div class="header-left" data-v-17e2787c><i class="fa-regular fa-envelope" data-v-17e2787c></i><div class="message" content="【系统通知】感谢大家对我们项目的关注与支持!希望能为我们的项目点一个Star,您的支持对我们来说至关重要。" data-v-17e2787c></div></div><div class="header-right" data-v-17e2787c><span data-v-17e2787c>12:00:00</span><span data-v-17e2787c>2024-12-34</span><span data-v-17e2787c>Monday</span><span data-v-17e2787c>13°c</span></div>',3)])]))}}),L=(f,n)=>{const i=f.__vccOpts||f;for(const[r,t]of n)i[r]=t;return i},Se=L(ke,[["__scopeId","data-v-17e2787c"]]),Pe={class:"layout-footer"},Ee=x({__name:"LayoutFooter",setup(f){const n=Z({isWarming:!1}),i=B("events"),r=async()=>{n.isWarming=!n.isWarming,n.isWarming&&i?i.startWarming():i&&i.stopWarming()},t=V(()=>{const o={};return o.cursor="pointer",n.isWarming?o.color="#5bc7fa":o.color="#fff",o});return(o,l)=>(y(),w("div",Pe,[e("div",{class:"item",style:A(t.value),onClick:r},m(n.isWarming?"取消告警":"设备告警"),5)]))}}),Ae=L(Ee,[["__scopeId","data-v-a0512409"]]),We={class:"layout-loading"},Te={class:"loading-tip"},ze=x({__name:"LayoutLoading",props:{loading:{}},setup(f){return(n,i)=>ae((y(),w("div",We,[i[0]||(i[0]=e("div",{class:"loading-gif"},null,-1)),e("div",Te," 模型正在加载中 ("+m(f.loading.loaded)+"/"+m(f.loading.total)+") ... ",1)],512)),[[ne,f.loading.isLoading]])}}),Ie=L(ze,[["__scopeId","data-v-c607f5e9"]]);function He(){const f=C(null),n=D(null),i=()=>{var l;return(l=n.value)==null?void 0:l.resize()},r=()=>{var l;return(l=n.value)==null?void 0:l.clear()},t=(l="light")=>{var v;n.value&&((v=n.value)==null||v.dispose()),G.isElement(f.value)?n.value=ie(f.value,l):console.warn("容器还未初始化"),window.removeEventListener("resize",i),window.addEventListener("resize",i)},o=l=>{var v;n.value||t(),(v=n.value)==null||v.setOption(l)};return I(()=>{window.removeEventListener("resize",i)}),T(()=>{window.addEventListener("resize",i)}),{container:f,chart:n,setOption:o,resize:i,clear:r,echarts:oe}}const Oe={class:"layout-panel"},Re={class:"panel-header"},Ne={class:"panel-header-title"},Fe={class:"panel-body"},Ue=x({__name:"LayoutPanel",props:{title:{}},setup(f){return(n,i)=>(y(),w("div",Oe,[e("div",Re,[e("div",Ne,m(f.title),1)]),e("div",Fe,[le(n.$slots,"default",{},void 0)])]))}}),J=L(Ue,[["__scopeId","data-v-9556f20e"]]),je=x({__name:"WidgetPanel01",setup(f){const{container:n,echarts:i,setOption:r}=He(),t=()=>{const v=[],_=new Date;for(let d=60;d>=0;d-=1){const c=new Date(_.getTime()-d*60*1e3),s=String(c.getMinutes()).padStart(2,"0");v.push(`${c.getHours()}:${s}`)}return v},o=()=>{const v=[];for(let d=60;d>=0;d-=1){const c=Math.random()*10-5,s=Math.max(0,Math.min(100,5+c+Math.sin(d/10)*5));v.push(s.toFixed(1))}return v},l=()=>({legend:{show:!1},tooltip:{trigger:"axis",backgroundColor:"#000",borderColor:"#333",textStyle:{color:"#fff"},formatter(v){const _=v[0];return`<div style="padding: 5px 0;">
          <div style="color: #fff; font-size: 14px;">${_.name}</div>
          <div style="color: #00fea9; font-size: 16px; margin-top: 5px;">故障变化率: ${_.value}%</div>
        </div>`}},grid:{left:"4%",right:"4%",bottom:"0%",top:"20%",containLabel:!0},xAxis:{type:"category",axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#fff",margin:10,fontSize:12,interval:9},data:t()},yAxis:{type:"value",name:"故障变化率(%)",nameTextStyle:{color:"#fff",fontSize:12},axisLabel:{color:"#fff"},splitLine:{lineStyle:{color:"#c8c8c830",type:"dashed"}},min:0,max:100},series:[{name:"故障变化率",type:"line",smooth:!0,symbol:"none",lineStyle:{color:"rgba(0, 254, 169, 1)",width:2},areaStyle:{color:new i.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(0, 254, 169, 0.3)"},{offset:1,color:"rgba(0, 254, 169, 0.01)"}])},data:o()}]});return T(()=>{ee(()=>{const v=l();r(v)})}),(v,_)=>(y(),W(J,{title:"设备故障变化率"},{default:q(()=>[e("div",{class:"container",ref_key:"container",ref:n},null,512)]),_:1}))}}),Be=L(je,[["__scopeId","data-v-0544581d"]]),Ve={class:"weather-monitor"},Ge={class:"weather-label"},qe={class:"weather-value"},Ke={class:"value"},Je={class:"unit"},Qe=x({__name:"WidgetPanel04",setup(f){const n=[{icon:"fa-solid fa-server",label:"服务器机柜",value:"23",unit:"个"},{icon:"fa-solid fa-network-wired",label:"网络设备",value:"23",unit:"个"},{icon:"fa-solid fa-bolt",label:"电源柜",value:"23",unit:"个"},{icon:"fa-solid fa-temperature-three-quarters",label:"温湿度传感器",value:"11",unit:"个"},{icon:"fa-solid fa-snowflake",label:"空调系统",value:"63",unit:"个"},{icon:"fa-solid fa-shield-alt",label:"防火墙",value:"23",unit:"个"},{icon:"fa-solid fa-ethernet",label:"交换机",value:"12",unit:"个"},{icon:"fa-solid fa-database",label:"存储设备",value:"12",unit:"个"},{icon:"fa-solid fa-video",label:"监控设备",value:"13",unit:"个"}];return(i,r)=>(y(),W(J,{title:"设备规模"},{default:q(()=>[e("div",Ve,[(y(),w(H,null,O(n,(t,o)=>e("div",{key:o,class:"widget-weather-item"},[e("div",{class:te(["weather-icon",t.icon])},null,2),e("div",Ge,m(t.label),1),e("div",qe,[e("span",Ke,m(t.value),1),e("span",Je,m(t.unit),1)])])),64))])]),_:1}))}}),Xe=L(Qe,[["__scopeId","data-v-bfd63f68"]]),Ye={class:"content"},Ze={class:"device-info"},et={class:"device-name"},tt={class:"device-event"},st={class:"device-time"},at=x({__name:"AlarmDeviceList",props:{devices:{}},emits:["close"],setup(f,{emit:n}){const i=f,r=n,t=C(i.devices),o=_=>({1:"#74fabd",2:"#5bc7fa",3:"#f1bd49"})[_],l=_=>({1:"一般",2:"中等",3:"严重"})[_],v=()=>{r("close")};return(_,d)=>(y(),w("div",{class:"alarm-device-list",onClick:d[0]||(d[0]=P(()=>{},["stop"]))},[e("div",{class:"header"},[d[1]||(d[1]=e("div",{class:"title"},"告警设备列表",-1)),e("div",{class:"close-btn",onClick:v},"×")]),e("div",Ye,[(y(!0),w(H,null,O(t.value,c=>(y(),w("div",{class:"device-item",key:c.id},[e("div",Ze,[e("div",et,m(c.name),1),e("div",tt,m(c.event),1)]),e("div",st,m(c.time),1),e("div",{class:"device-type",style:A({background:o(c.type)})},m(l(c.type)),5)]))),128))])]))}}),nt=L(at,[["__scopeId","data-v-9760bf3f"]]),ot={class:"item-name"},it={class:"item-type"},lt={class:"item-time"},rt=x({__name:"WidgetPanel06",setup(f){const{disableControls:n,enableControls:i}=B("events"),r=B("mask"),t=C(!1);re(t,c=>{c?(n(),r.show()):(i(),r.hide())});const o=C([{name:"1#服务器机柜",event:"温度过高",type:1,time:"08:21"},{name:"23#网络设备",event:"网络异常",type:3,time:"08:32"},{name:"9#电源柜",event:"电压波动",type:2,time:"09:44"},{name:"2#服务器机柜",event:"内存过载",type:3,time:"12:53"},{name:"18#空调系统",event:"制冷异常",type:3,time:"14:15"},{name:"7#UPS设备",event:"电池低电压",type:2,time:"14:45"},{name:"26#交换机",event:"端口故障",type:2,time:"14:59"},{name:"3#服务器机柜",event:"硬盘故障",type:1,time:"16:42"},{name:"6#网络设备",event:"丢包率过高",type:2,time:"17:43"},{name:"1#服务器机柜",event:"CPU过载",type:1,time:"08:21"},{name:"23#温湿度传感器",event:"湿度超标",type:3,time:"08:32"},{name:"9#防火墙",event:"流量异常",type:2,time:"09:44"},{name:"2#电源柜",event:"电流过高",type:3,time:"12:53"},{name:"18#服务器机柜",event:"风扇故障",type:3,time:"14:15"},{name:"7#路由器",event:"连接中断",type:2,time:"14:45"},{name:"26#负载均衡器",event:"性能下降",type:2,time:"14:59"},{name:"7#服务器机柜",event:"内存泄漏",type:2,time:"14:45"},{name:"26#存储设备",event:"读写错误",type:2,time:"14:59"},{name:"7#备份系统",event:"备份失败",type:2,time:"14:45"},{name:"26#监控设备",event:"信号丢失",type:2,time:"14:59"},{name:"7#安全设备",event:"入侵检测",type:2,time:"14:45"},{name:"26#门禁系统",event:"权限异常",type:2,time:"14:59"},{name:"7#消防设备",event:"烟雾报警",type:2,time:"14:45"},{name:"26#环境传感器",event:"温度异常",type:2,time:"14:59"}]),l=V(()=>o.value.map((c,s)=>({id:s,name:c.name,event:c.event,type:c.type,time:c.time}))),v=C(),_=(c,s=!1)=>{const g={1:"#74fabd",2:"#5bc7fa",3:"#f1bd49"};return s?`linear-gradient(90deg, ${g[c]}77 , transparent )`:g[c]};let d=null;return T(()=>{d&&window.clearInterval(d),d=setInterval(()=>{v.value.classList.add("scroll"),setTimeout(()=>{if(!d)return;v.value.classList.remove("scroll");const c=o.value.shift();c&&o.value.push(c)},2e3)},3e3)}),I(()=>{d&&(window.clearInterval(d),d=null)}),(c,s)=>(y(),W(J,{title:"预警情况"},{default:q(()=>[e("div",{class:"wrap",onClick:s[0]||(s[0]=g=>t.value=!0)},[e("div",{class:"item-list",ref_key:"container",ref:v},[(y(!0),w(H,null,O(o.value,(g,$)=>(y(),w("div",{class:"item",key:$,style:A({background:_(g.type,!0)})},[e("div",{class:"item-circle",style:A({background:_(g.type)})},null,4),e("div",ot,m(g.name),1),e("div",it,m(g.event),1),e("div",lt,m(g.time),1)],4))),128))],512)]),t.value?(y(),W(nt,{key:0,devices:l.value,onClose:s[1]||(s[1]=g=>t.value=!1),onClick:s[2]||(s[2]=P(()=>{},["stop"]))},null,8,["devices"])):K("",!0)]),_:1}))}}),ct=L(rt,[["__scopeId","data-v-11b6b20f"]]),dt={class:"header"},vt={class:"title"},ut={class:"content"},mt={class:"info-section"},ft={class:"info-item"},pt={class:"info-value"},_t={class:"info-item"},gt={class:"info-item"},ht={class:"info-value"},yt={class:"info-item"},bt={class:"info-value"},wt={class:"info-section"},Mt={class:"info-item"},xt={class:"info-value"},Lt={class:"info-item"},Ct={class:"info-value"},$t={class:"info-item"},Dt={class:"info-value"},kt={class:"info-item"},St={class:"info-value"},Pt={class:"info-item"},Et={class:"info-value"},At={class:"info-section"},Wt={class:"info-item"},Tt={class:"info-value"},zt={class:"info-item"},It={class:"info-value"},Ht={class:"info-item"},Ot={class:"info-value"},Rt={class:"info-item"},Nt={class:"info-value"},Ft={class:"info-section"},Ut={class:"alarm-list"},jt={class:"alarm-info"},Bt={class:"alarm-name"},Vt={class:"alarm-time"},Gt=x({__name:"DeviceDetailPanel",props:{deviceData:{}},emits:["close"],setup(f,{emit:n}){const i=f,r=n,t=V(()=>i.deviceData),o=c=>({normal:"status-normal",warning:"status-warning",error:"status-error"})[c]||"status-normal",l=c=>({normal:"正常",warning:"警告",error:"故障"})[c]||"正常",v=c=>({warning:"#f1bd49",error:"#ff0000",info:"#5bc7fa"})[c]||"#5bc7fa",_=c=>({warning:"⚠",error:"❌",info:"ℹ"})[c]||"ℹ",d=()=>{r("close")};return(c,s)=>(y(),w("div",{class:"device-detail-panel",onClick:s[0]||(s[0]=P(()=>{},["stop"]))},[e("div",dt,[e("div",vt,m(t.value.name),1),e("div",{class:"close-btn",onClick:P(d,["stop"])},"×")]),e("div",ut,[e("div",mt,[s[5]||(s[5]=e("div",{class:"info-title"},"设备基本信息",-1)),e("div",ft,[s[1]||(s[1]=e("div",{class:"info-label"},"设备类型",-1)),e("div",pt,m(t.value.type),1)]),e("div",_t,[s[2]||(s[2]=e("div",{class:"info-label"},"设备状态",-1)),e("div",{class:te(["info-value",o(t.value.status)])},m(l(t.value.status)),3)]),e("div",gt,[s[3]||(s[3]=e("div",{class:"info-label"},"设备编号",-1)),e("div",ht,m(t.value.serialNumber),1)]),e("div",yt,[s[4]||(s[4]=e("div",{class:"info-label"},"安装位置",-1)),e("div",bt,m(t.value.location),1)])]),e("div",wt,[s[11]||(s[11]=e("div",{class:"info-title"},"实时参数",-1)),e("div",Mt,[s[6]||(s[6]=e("div",{class:"info-label"},"温度",-1)),e("div",xt,m(t.value.temperature)+"°C",1)]),e("div",Lt,[s[7]||(s[7]=e("div",{class:"info-label"},"湿度",-1)),e("div",Ct,m(t.value.humidity)+"%",1)]),e("div",$t,[s[8]||(s[8]=e("div",{class:"info-label"},"电压",-1)),e("div",Dt,m(t.value.voltage)+"V",1)]),e("div",kt,[s[9]||(s[9]=e("div",{class:"info-label"},"电流",-1)),e("div",St,m(t.value.current)+"A",1)]),e("div",Pt,[s[10]||(s[10]=e("div",{class:"info-label"},"功率",-1)),e("div",Et,m(t.value.power)+"W",1)])]),e("div",At,[s[16]||(s[16]=e("div",{class:"info-title"},"运行状态",-1)),e("div",Wt,[s[12]||(s[12]=e("div",{class:"info-label"},"CPU 负载",-1)),e("div",Tt,m(t.value.cpuLoad)+"%",1)]),e("div",zt,[s[13]||(s[13]=e("div",{class:"info-label"},"内存使用",-1)),e("div",It,m(t.value.memoryUsage)+"%",1)]),e("div",Ht,[s[14]||(s[14]=e("div",{class:"info-label"},"磁盘使用",-1)),e("div",Ot,m(t.value.diskUsage)+"%",1)]),e("div",Rt,[s[15]||(s[15]=e("div",{class:"info-label"},"网络流量",-1)),e("div",Nt,m(t.value.networkTraffic)+" Mbps",1)])]),e("div",Ft,[s[17]||(s[17]=e("div",{class:"info-title"},"告警信息",-1)),e("div",Ut,[(y(!0),w(H,null,O(t.value.alarms,g=>(y(),w("div",{class:"alarm-item",key:g.id},[e("div",{class:"alarm-icon",style:A({background:v(g.type)})},m(_(g.type)),5),e("div",jt,[e("div",Bt,m(g.name),1),e("div",Vt,m(g.time),1)])]))),128))])])])]))}}),qt=L(Gt,[["__scopeId","data-v-eccd312f"]]),Kt={class:"label-wrapper"},Jt=x({__name:"WidgetLabel",props:{name:{},position:{}},setup(f){const n=f,i=C(!1),r=()=>{const t={name:n.name,type:"未知设备",status:"normal",serialNumber:`1000${Math.floor(Math.random()*9e3)}`,location:"数据中心 A 区",temperature:Math.floor(Math.random()*30)+20,humidity:Math.floor(Math.random()*40)+40,voltage:Math.floor(Math.random()*20)+220,current:Math.floor(Math.random()*10)+5,power:Math.floor(Math.random()*2e3)+1e3,cpuLoad:Math.floor(Math.random()*60)+20,memoryUsage:Math.floor(Math.random()*50)+30,diskUsage:Math.floor(Math.random()*40)+40,networkTraffic:Math.floor(Math.random()*1e3)+500,alarms:[]};return n.name.includes("服务器机柜")?(t.type="服务器机柜",t.status="normal",t.alarms=[{id:1,name:"温度过高",type:"warning",time:"10:23"},{id:2,name:"内存过载",type:"error",time:"09:15"}]):n.name.includes("网络设备")?(t.type="网络设备",t.status="warning",t.alarms=[{id:1,name:"网络延迟过高",type:"warning",time:"11:05"}]):n.name.includes("电源柜")?(t.type="电源柜",t.status="normal",t.alarms=[]):(t.type="其他设备",t.status="normal",t.alarms=[]),t};return(t,o)=>(y(),w("div",Kt,[e("div",{class:"label",onClick:o[0]||(o[0]=P(l=>i.value=!0,["stop"]))},m(f.name),1),i.value?(y(),W(qt,{key:0,"device-data":r(),onClose:o[1]||(o[1]=l=>i.value=!1),onClick:o[2]||(o[2]=P(()=>{},["stop"]))},null,8,["device-data"])):K("",!0)]))}}),Qt=L(Jt,[["__scopeId","data-v-f4d6ee0d"]]);function Xt(f){const n=f||C(null),i=D(null),r=D(null),t=D(null),o=D(null),l=D(null),v=new Map,_=[],d=new he,c=new Map,s=()=>{const p=d.getDelta();if(t.value&&i.value&&r.value){t.value.render(i.value,r.value);const u=d.getDelta();_.forEach(a=>a.update(u)),v.forEach(a=>a.render(p)),c.forEach(a=>G.isFunction(a)&&a(p)),o.value&&o.value.render(i.value,r.value),ye.update()}requestAnimationFrame(s)},g=()=>{if(!n.value)return;const{clientWidth:p,clientHeight:u}=n.value;if(i.value=new ve,r.value=new Q(45,p/u,1,1e4),r.value.position.set(20,15,20),t.value=new ue({antialias:!0,alpha:!0}),t.value.shadowMap.enabled=!1,t.value.setSize(p,u),t.value.setClearAlpha(.5),n.value.appendChild(t.value.domElement),o.value=new me,o.value.setSize(p,u),o.value.domElement.className="css2d-renderer",o.value.domElement.style.position="absolute",o.value.domElement.style.top="0px",o.value.domElement.style.pointerEvents="none",o.value.domElement.style.zIndex="100",n.value.appendChild(o.value.domElement),r.value&&t.value&&(l.value=new fe(r.value,t.value.domElement),l.value.minPolarAngle=0,l.value.enableDamping=!0,l.value.dampingFactor=.1,l.value.target.set(0,5,0),l.value.maxPolarAngle=Math.PI/2,l.value.minDistance=10,l.value.maxDistance=100,l.value.update()),i.value){const a=new pe(10066329,10);i.value.add(a);const h=new _e(16777215,.5);h.position.set(20,20,20),h.position.multiplyScalar(1),h.castShadow=!0,h.shadow.mapSize=new ge(1024,1024),i.value.add(h)}},$=new ce;$.setDecoderPath("/js/draco/gltf/"),$.setDecoderConfig({type:"js"});const R=p=>{const u=new de;u.setDRACOLoader($);const a=(M,E)=>E(M),h=(M,E)=>{console.error("模型加载失败:",p,M),E(M)};return new Promise((M,E)=>{u.load(p,U=>a(U,M),void 0,U=>h(U,E))})},N=new Promise((p,u)=>{T(()=>{const a=()=>{console.log("boostrap 调用时 container.value:",n.value);try{if(!n.value||n.value.clientHeight===0){console.log("容器尺寸为0，等待DOM更新"),setTimeout(a,100);return}g(),i.value&&r.value&&t.value?(console.log("Three.js 场景初始化成功"),window.addEventListener("resize",z),s(),p()):(console.error("Three.js 场景初始化失败：缺少必要组件",{scene:!!i.value,camera:!!r.value,renderer:!!t.value,container:!!n.value}),u(new Error("Three.js 场景初始化失败")))}catch(h){console.error("Three.js 场景初始化过程中发生错误：",h),u(h)}};n.value?(console.log("容器已经准备好，立即初始化"),a()):(console.log("容器尚未准备好，等待 500ms 后重试"),setTimeout(a,500))}),I(()=>{window.removeEventListener("resize",z)})}),z=()=>{if(!n.value||!r.value||!t.value||!o.value)return;const{clientWidth:p,clientHeight:u}=n.value;r.value instanceof Q&&(r.value.aspect=p/u,r.value.updateProjectionMatrix()),t.value.setSize(p,u),o.value.setSize(p,u)};return{container:n,scene:i,camera:r,renderer:t,cssRenderer:o,controls:l,mixers:_,renderMixins:c,composers:v,loadGltf:R,enableControls:()=>{l.value&&(l.value.enabled=!0)},disableControls:()=>{l.value&&(l.value.enabled=!1)},boostrapPromise:N}}const S={BuildingModel:"/models/base.glb",DeviceModel:"/models/devices.glb",LineModel:"/models/lines.gltf"},Y=[{name:"1# 服务器机柜",position:[-32,8,-22]},{name:"2# 服务器机柜",position:[-20.2,8,-22]},{name:"3# 服务器机柜",position:[-8.4,8,-22]},{name:"4# 服务器机柜",position:[3.4,8,-22]},{name:"5# 服务器机柜",position:[15.2,8,-22]},{name:"6# 服务器机柜",position:[27,8,-22]},{name:"1# 网络设备",position:[-32,8,-6]},{name:"2# 网络设备",position:[-20.2,8,-6]},{name:"3# 网络设备",position:[-8.4,8,-6]},{name:"4# 网络设备",position:[3.4,8,-6]},{name:"5# 网络设备",position:[15.2,8,-6]},{name:"6# 网络设备",position:[27,8,-6]},{name:"1# 电源柜",position:[-33,6,14]},{name:"2# 电源柜",position:[-21.2,6,14]},{name:"3# 电源柜",position:[-9.4,6,14]},{name:"4# 电源柜",position:[2.4,6,14]},{name:"5# 电源柜",position:[14.2,6,14]},{name:"6# 电源柜",position:[26,6,14]}];function Yt(f){const{container:n,scene:i,loadGltf:r,renderMixins:t,enableControls:o,disableControls:l,boostrapPromise:v}=Xt(f),_={building:null,devices:null,lines:null},d=Z({total:3,loaded:0,isLoading:!0}),c=D([]),s=C(null),g=D(null),$=async()=>{const b=async()=>{try{console.log("开始加载建筑模型:",S.BuildingModel);const a=await r(S.BuildingModel);d.loaded+=1,_.building=a.scene,i.value.add(a.scene),console.log("建筑模型加载成功")}catch(a){console.error("建筑模型加载失败:",a),d.loaded+=1}},p=async()=>{try{console.log("开始加载设备模型:",S.DeviceModel);const a=await r(S.DeviceModel);a.scene.children[4]&&a.scene.children[4].children?c.value.push(...a.scene.children[4].children):console.warn("设备模型结构不符合预期"),d.loaded+=1,_.devices=a.scene,i.value.add(a.scene),console.log("设备模型加载成功")}catch(a){console.error("设备模型加载失败:",a),d.loaded+=1}},u=async()=>{try{console.log("开始加载线路模型:",S.LineModel);const a=await r(S.LineModel);d.loaded+=1,_.lines=a.scene,i.value.add(a.scene),console.log("线路模型加载成功")}catch(a){console.error("线路模型加载失败:",a),d.loaded+=1}};await Promise.all([b(),p(),u()]),d.isLoading=!1,d.loaded=3},R=()=>{if(!_.building)return;const b=[];_.building.traverse(u=>{if("name"in u&&u.name.includes("道路箭头")){const a=u;b.push(a.material.map)}});const p=()=>{b.forEach(u=>{const a=u;a.offset.y=(a.offset.y+.02)%1e4})};t.set("road-arrow",p)},N=()=>{if(console.log("addDeviceLabels 函数被调用"),!i.value){console.warn("场景未初始化，无法添加设备标签");return}const b=(p,u)=>{const a=x({render(){return Me(p,u)}}),h=k(a);return we(h,document.createElement("div")),h.el};console.log("LabelPositions 数组长度:",Y.length),Y.forEach((p,u)=>{console.log(`正在添加第 ${u+1} 个设备标签:`,p);const a=b(Qt,p);if(a){console.log("成功创建 DOM 元素:",a.outerHTML);const h=new be(a);h.position.set(p.position[0],p.position[1],p.position[2]),i.value.add(h),console.log("成功添加到场景")}else console.warn("无法创建 DOM 元素")})},z=()=>{const b=()=>{g.value&&g.value.traverse(u=>{if(!(u instanceof j))return;const a=u;Array.isArray(a.material)?a.material.forEach(h=>{h&&"emissive"in h&&h.emissive.setHex(a.currentHex)}):a.material&&"emissive"in a.material&&a.material.emissive.setHex(a.currentHex)});const p=G.sample([0,1,2,3,4,5]);g.value=c.value[p],g.value.traverse(u=>{if(!(u instanceof j))return;const a=u;Array.isArray(a.material)?a.material=a.material.map(M=>M.clone()):a.material=a.material.clone();const h=Array.isArray(a.material)?a.material[0]:a.material;if(h&&"emissive"in h){const M=h;a.currentHex=a.currentHex??M.emissive.getHex(),M.emissive.setHex(16711680)}})};b(),s.value=setInterval(b,1e3*2)},F=()=>{g.value&&g.value.traverse(b=>{if(!(b instanceof j))return;const p=b;b.material.emissive.setHex(p.currentHex)}),s.value&&(window.clearInterval(s.value),s.value=null)};return T(()=>{console.log("useDataCenter onMounted 钩子被调用"),ee(async()=>{try{console.log("开始等待 boostrapPromise 解析"),await v,console.log("boostrapPromise 已解析"),i.value?(console.log("场景已初始化，开始加载模型"),await $(),R(),N()):console.error("场景初始化失败，无法继续加载模型")}catch(b){console.error("初始化过程中发生错误：",b)}})}),I(()=>{F()}),{container:n,loadModel:$,loading:d,startWarming:z,stopWarming:F,enableControls:o,disableControls:l}}const Zt={class:"layout"},es={class:"layout-main"},ts={class:"main-left"},ss={class:"main-right"},as={key:0,class:"mask"},ns=x({__name:"App",setup(f){const n=C(null),{loading:i,startWarming:r,stopWarming:t,enableControls:o,disableControls:l}=Yt(n);xe(()=>{});const v=C(!1);return X("mask",{show:()=>{v.value=!0},hide:()=>{v.value=!1}}),X("events",{startWarming:r,stopWarming:t,enableControls:o,disableControls:l}),(_,d)=>(y(),w("div",Zt,[k(Se),k(Ae),k(Ie,{loading:Le(i)},null,8,["loading"]),e("div",es,[e("div",ts,[k(Xe)]),e("div",ss,[k(Be),k(ct)]),e("div",{class:"main-middle",ref_key:"threeContainer",ref:n},null,512),v.value?(y(),w("div",as)):K("",!0)])]))}}),os=L(ns,[["__scopeId","data-v-37dc011c"]]),is=async()=>{Ce(os).mount("#app");const n=[1920,1080];$e.init({el:"#app",dw:n[0],dh:n[1],resize:!0})};is();
